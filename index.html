<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Barça Site | Personal Portal</title>
    <link rel="stylesheet" href="style.css">
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700;900&display=swap" rel="stylesheet">
</head>
<body>

    <header>
        <nav class="nav-container">
            <div class="logo">BARÇA<span class="gold">SITE</span></div>
            <div class="menu-toggle" id="mobile-menu">
                <span class="bar"></span><span class="bar"></span><span class="bar"></span>
            </div>
            <ul class="nav-links" id="nav-links">
                <li><a href="#home">Home</a></li>
                <li><a href="#timer">Match Center</a></li>
                <li><a href="#news">News</a></li>
                <li><a href="#trophies">Trophies</a></li>
            </ul>
        </nav>
    </header>

    <section class="hero" id="home">
        <div class="hero-overlay">
            <span class="est-tag">ESTABLISHED 1899</span>
            <h1>MÉS QUE UN CLUB</h1>
            <p class="slogan-bottom">VISCA EL BARÇA</p>
        </div>
    </section>

    <section class="timer-section" id="timer">
        <div class="timer-card">
            <div class="match-status" id="status-label">FETCHING LIVE DATA...</div>
            <h2 class="match-title">BARÇA <span class="gold-text">VS</span> <span id="opponent-name">OPPONENT</span></h2>
            <p class="match-meta" id="match-date-display">Checking fixtures...</p>
            
            <div class="countdown-grid" id="timer-display">
                <div class="time-box"><span id="days">00</span><p>Days</p></div>
                <div class="time-box"><span id="hours">00</span><p>Hours</p></div>
                <div class="time-box"><span id="mins">00</span><p>Mins</p></div>
                <div class="time-box"><span id="secs">00</span><p>Secs</p></div>
            </div>
        </div>
    </section>

    <main class="container">
        <section id="news" class="section" style="padding-bottom: 50px;">
            <h2 class="section-title">Barça Pulse <span class="live-dot"></span></h2>
            <div id="news-container" class="news-grid">
                <p class="loading">Fetching latest news...</p>
            </div>
        </section>

        <section id="trophies" class="section">
            <h2 class="section-title">Official Trophy Cabinet</h2>
            <div class="trophy-grid">
                <a href="ucl.html" style="text-decoration: none;">
                    <div class="trophy-card interactive-card">
                        <img src="ucl.png" alt="Champions League">
                        <h4>5 Champions League</h4>
                        <p class="click-hint">Tap to view History ➔</p>
                    </div>
                </a>
                <div class="trophy-card"><img src="liga.png" alt="La Liga"><h4>28 La Liga</h4></div>
                <div class="trophy-card"><img src="copa.png" alt="Copa del Rey"><h4>32 Copa del Rey</h4></div>
            </div>
        </section>
    </main>

    <footer><p>Visca el Barça! | barca-site &copy; 2026</p></footer>

    <script>
        let countdownInterval;

        async function updateMatchCenter() {
            const apiKey = '38355029a465447bab7a203cb102e058';
            const proxyUrl = 'https://api.allorigins.win/raw?url=';
            const targetUrl = 'https://api.football-data.org/v4/teams/81/matches';

            try {
                const response = await fetch(proxyUrl + encodeURIComponent(targetUrl), {
                    headers: { 'X-Auth-Token': apiKey }
                });
                const data = await response.json();
                
                // Identify Live or Next Fixture
                const liveMatch = data.matches.find(m => m.status === 'IN_PLAY' || m.status === 'LIVE' || m.status === 'PAUSED');
                const nextMatch = data.matches.find(m => m.status === 'SCHEDULED' || m.status === 'TIMED');
                const currentMatch = liveMatch || nextMatch;

                if (currentMatch) {
                    const opponent = currentMatch.homeTeam.id === 81 ? currentMatch.awayTeam.name : currentMatch.homeTeam.name;
                    const matchTime = new Date(currentMatch.utcDate).getTime();

                    document.getElementById('opponent-name').innerText = opponent.toUpperCase();
                    document.getElementById('match-date-display').innerText = new Date(currentMatch.utcDate).toLocaleString();

                    if (liveMatch) {
                        document.getElementById('status-label').innerText = "MATCH LIVE";
                        document.getElementById('status-label').classList.add('live-active');
                        document.getElementById('timer-display').innerHTML = `<h3 class="live-msg">THE GAME IS IN PROGRESS</h3>`;
                    } else {
                        document.getElementById('status-label').innerText = "NEXT MATCH";
                        document.getElementById('status-label').classList.remove('live-active');
                        startCountdown(matchTime);
                    }
                }
            } catch (e) {
                document.getElementById('status-label').innerText = "OFFLINE MODE";
            }
        }

        function startCountdown(endTime) {
            if (countdownInterval) clearInterval(countdownInterval);
            countdownInterval = setInterval(() => {
                const now = new Date().getTime();
                const gap = endTime - now;
                if (gap <= 0) { clearInterval(countdownInterval); updateMatchCenter(); return; }
                const second = 1000, minute = second * 60, hour = minute * 60, day = hour * 24;
                document.getElementById('days').innerText = Math.floor(gap / day).toString().padStart(2, '0');
                document.getElementById('hours').innerText = Math.floor((gap % day) / hour).toString().padStart(2, '0');
                document.getElementById('mins').innerText = Math.floor((gap % hour) / minute).toString().padStart(2, '0');
                document.getElementById('secs').innerText = Math.floor((gap % minute) / second).toString().padStart(2, '0');
            }, 1000);
        }

        async function fetchBarcaNews() {
            const apiKey = 'a144ee981ae649ba9f906b0a86b14635';
            const proxyUrl = 'https://api.allorigins.win/raw?url=';
            const targetUrl = `https://newsapi.org/v2/everything?q=FC+Barcelona&sortBy=publishedAt&language=en&pageSize=3&apiKey=${apiKey}`;
            try {
                const response = await fetch(proxyUrl + encodeURIComponent(targetUrl));
                const data = await response.json();
                const container = document.getElementById('news-container');
                if (data.status === "ok") {
                    container.innerHTML = ''; 
                    data.articles.forEach(article => {
                        container.innerHTML += `
                            <div class="news-card">
                                <img src="${article.urlToImage || 'https://via.placeholder.com/400x200/111/edbb00?text=Barca+News'}" class="news-image">
                                <div class="news-content">
                                    <h3>${article.title}</h3>
                                    <p>${article.description ? article.description.substring(0, 100) + '...' : 'Latest updates.'}</p>
                                    <a href="${article.url}" target="_blank" class="gold-btn" style="font-size: 0.8rem; padding: 10px 20px; text-decoration: none;">Read More</a>
                                </div>
                            </div>`;
                    });
                }
            } catch (e) { document.getElementById('news-container').innerHTML = '<p>Latest news arriving soon.</p>'; }
        }

        updateMatchCenter();
        fetchBarcaNews();
        document.querySelector('#mobile-menu').addEventListener('click', () => {
            document.querySelector('#nav-links').classList.toggle('active');
        });
    </script>
</body>
</html>
